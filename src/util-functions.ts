import fetch from 'node-fetch'
import * as fs from 'fs'


export const fetchData = async (url, op) => {
  return await fetch(url, op)
}

export const downloadFile = (async (url, op={}, path) => {
  const res: any = await fetch(url, op);
  const fileStream = fs.createWriteStream(path);
  await new Promise((resolve, reject) => {
    res.body.pipe(fileStream);
    res.body.on("error", (err) => {
      reject(err);
    });
    fileStream.on("finish", function() {
      resolve();
    });
  });
});

export const writeFile = (list: string[], path: string) => {
  console.log(path)
  const file = fs.createWriteStream(path);
  file.on('error', err => { console.error(err) });
  list.forEach(l => { file.write(l + '\n'); });
  file.end();
}

